<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="八、终极实战：SpringBoot版微头条实战目录 一、微头条案例介绍 微头条业务简介 技术栈介绍 功能展示   二、微头条前端搭建 三、基于SpringBoot搭建项目基础架构 1. 数据库脚本执行 2. 搭建SprintBoot工程 3. MybatisX逆向工程   四、后台功能开发 4.1 用户模块开发 4.2 首页模块开发 4.3 头条模块开发   五、前后端联调  一、微头条案例介绍微">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2023/11/14/ssm-md-master/%E6%96%B0%E7%89%88SSM%E6%95%B4%E5%90%88+SpringBoot3%E7%AC%94%E8%AE%B0/%E5%85%AB%E3%80%81%E7%BB%88%E6%9E%81%E5%AE%9E%E6%88%98%EF%BC%9ASpringBoot%E7%89%88%E5%BE%AE%E5%A4%B4%E6%9D%A1%E5%AE%9E%E6%88%98/%E5%85%AB%E3%80%81%E7%BB%88%E6%9E%81%E5%AE%9E%E6%88%98%EF%BC%9ASpringBoot%E7%89%88%E5%BE%AE%E5%A4%B4%E6%9D%A1%E5%AE%9E%E6%88%98/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="八、终极实战：SpringBoot版微头条实战目录 一、微头条案例介绍 微头条业务简介 技术栈介绍 功能展示   二、微头条前端搭建 三、基于SpringBoot搭建项目基础架构 1. 数据库脚本执行 2. 搭建SprintBoot工程 3. MybatisX逆向工程   四、后台功能开发 4.1 用户模块开发 4.2 首页模块开发 4.3 头条模块开发   五、前后端联调  一、微头条案例介绍微">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/image/image_AEA1JELlwg.png">
<meta property="og:image" content="http://example.com/image/image_tanjgauKKL.png">
<meta property="og:image" content="http://example.com/image/image_UtZ3I_X_Pp.png">
<meta property="og:image" content="http://example.com/image/image_HZ3nuKozDC.png">
<meta property="og:image" content="http://example.com/image/image_pD-aiaiz-h.png">
<meta property="og:image" content="http://example.com/image/image_dvu1Jbs-mJ.png">
<meta property="og:image" content="http://example.com/image/image_H4EHFxNCQa.png">
<meta property="og:image" content="http://example.com/image/image_vslTlA9lTP.png">
<meta property="og:image" content="http://example.com/image/image_DLv8kvhW2X.png">
<meta property="og:image" content="http://example.com/image/image_4e4FtsunND.png">
<meta property="og:image" content="http://example.com/image/image_xIwwJ7Z2TM.png">
<meta property="og:image" content="http://example.com/image/image_kxo8e0mx90.png">
<meta property="og:image" content="http://example.com/image/image_ZU10-oHDap.png">
<meta property="og:image" content="http://example.com/image/image_TVundRSFu4.png">
<meta property="og:image" content="http://example.com/image/image_ezWGkcz3-q.png">
<meta property="og:image" content="http://example.com/image/image_tyJl6YQaLO.png">
<meta property="og:image" content="http://example.com/image/image_BN9CiapOe7.png">
<meta property="og:image" content="http://example.com/image/1687657661761_AB9lALvt6R.png">
<meta property="og:image" content="http://example.com/image/checkuserName_RkV-nZcKMO.gif">
<meta property="og:image" content="http://example.com/image/regist_HHgh8aMYtY.gif">
<meta property="og:image" content="http://example.com/image/image_AmGGS4B3gy.png">
<meta property="og:image" content="http://example.com/image/image_deWHSPD7Ma.png">
<meta property="og:image" content="http://example.com/image/image_8Na6D2JJhl.png">
<meta property="og:image" content="http://example.com/image/image_z3JT_Q93XX.png">
<meta property="og:image" content="http://example.com/image/1683883660552_8svcbagw2y.png">
<meta property="og:image" content="http://example.com/image/image_L870gB_yYk.png">
<meta property="og:image" content="http://example.com/image/image_QD2YtdsmHQ.png">
<meta property="article:published_time" content="2023-11-14T04:11:46.065Z">
<meta property="article:modified_time" content="2023-09-21T08:52:25.741Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/image/image_AEA1JELlwg.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-ssm-md-master/新版SSM整合+SpringBoot3笔记/八、终极实战：SpringBoot版微头条实战/八、终极实战：SpringBoot版微头条实战" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/11/14/ssm-md-master/%E6%96%B0%E7%89%88SSM%E6%95%B4%E5%90%88+SpringBoot3%E7%AC%94%E8%AE%B0/%E5%85%AB%E3%80%81%E7%BB%88%E6%9E%81%E5%AE%9E%E6%88%98%EF%BC%9ASpringBoot%E7%89%88%E5%BE%AE%E5%A4%B4%E6%9D%A1%E5%AE%9E%E6%88%98/%E5%85%AB%E3%80%81%E7%BB%88%E6%9E%81%E5%AE%9E%E6%88%98%EF%BC%9ASpringBoot%E7%89%88%E5%BE%AE%E5%A4%B4%E6%9D%A1%E5%AE%9E%E6%88%98/" class="article-date">
  <time class="dt-published" datetime="2023-11-14T04:11:46.065Z" itemprop="datePublished">2023-11-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="八、终极实战：SpringBoot版微头条实战"><a href="#八、终极实战：SpringBoot版微头条实战" class="headerlink" title="八、终极实战：SpringBoot版微头条实战"></a>八、终极实战：SpringBoot版微头条实战</h1><h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul>
<li><a href="#%E4%B8%80%E5%BE%AE%E5%A4%B4%E6%9D%A1%E6%A1%88%E4%BE%8B%E4%BB%8B%E7%BB%8D">一、微头条案例介绍</a><ul>
<li><a href="#%E5%BE%AE%E5%A4%B4%E6%9D%A1%E4%B8%9A%E5%8A%A1%E7%AE%80%E4%BB%8B">微头条业务简介</a></li>
<li><a href="#%E6%8A%80%E6%9C%AF%E6%A0%88%E4%BB%8B%E7%BB%8D">技术栈介绍</a></li>
<li><a href="#%E5%8A%9F%E8%83%BD%E5%B1%95%E7%A4%BA">功能展示</a></li>
</ul>
</li>
<li><a href="#%E4%BA%8C%E5%BE%AE%E5%A4%B4%E6%9D%A1%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA">二、微头条前端搭建</a></li>
<li><a href="#%E4%B8%89%E5%9F%BA%E4%BA%8ESpringBoot%E6%90%AD%E5%BB%BA%E9%A1%B9%E7%9B%AE%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84">三、基于SpringBoot搭建项目基础架构</a><ul>
<li><a href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C">1. 数据库脚本执行</a></li>
<li><a href="#2-%E6%90%AD%E5%BB%BASprintBoot%E5%B7%A5%E7%A8%8B">2. 搭建SprintBoot工程</a></li>
<li><a href="#3-MybatisX%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B">3. MybatisX逆向工程</a></li>
</ul>
</li>
<li><a href="#%E5%9B%9B%E5%90%8E%E5%8F%B0%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91">四、后台功能开发</a><ul>
<li><a href="#41-%E7%94%A8%E6%88%B7%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91">4.1 用户模块开发</a></li>
<li><a href="#42-%E9%A6%96%E9%A1%B5%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91">4.2 首页模块开发</a></li>
<li><a href="#43-%E5%A4%B4%E6%9D%A1%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91">4.3 头条模块开发</a></li>
</ul>
</li>
<li><a href="#%E4%BA%94%E5%89%8D%E5%90%8E%E7%AB%AF%E8%81%94%E8%B0%83">五、前后端联调</a></li>
</ul>
<h2 id="一、微头条案例介绍"><a href="#一、微头条案例介绍" class="headerlink" title="一、微头条案例介绍"></a>一、微头条案例介绍</h2><h3 id="微头条业务简介"><a href="#微头条业务简介" class="headerlink" title="微头条业务简介"></a>微头条业务简介</h3><ul>
<li>用户功能<ul>
<li>注册功能</li>
<li>登录功能</li>
<li>jwt实现</li>
</ul>
</li>
<li>头条新闻<ul>
<li>新闻的分页浏览</li>
<li>通过标题关键字搜索新闻</li>
<li>查看新闻详情</li>
<li>新闻的修改和删除</li>
</ul>
</li>
</ul>
<h3 id="技术栈介绍"><a href="#技术栈介绍" class="headerlink" title="技术栈介绍"></a>技术栈介绍</h3><blockquote>
<p>前端技术栈</p>
</blockquote>
<ul>
<li>ES6作为基础JS语法</li>
<li>nodejs用于运行环境</li>
<li>npm用于项目依赖管理工具</li>
<li>vite用于项目的构建架工具</li>
<li>Vue3用于项目数据的渲染框架</li>
<li>Axios用于前后端数据的交互</li>
<li>Router用于页面的跳转</li>
<li>Pinia用于存储用户的数据</li>
<li>LocalStorage作为用户校验token的存储手段</li>
<li>Element-Plus提供组件</li>
</ul>
<blockquote>
<p>后端技术栈</p>
</blockquote>
<ul>
<li>JAVA作为开发语言,版本为JDK17</li>
<li>Tomcat作为服务容器,版本为10.1.7</li>
<li>Mysql8用于项目存储数据</li>
<li>SpringMVC用于控制层实现前后端数据交互</li>
<li>MyBatis-Plus用于实现数据的CURD</li>
<li>Druid用于提供数据源的连接池</li>
<li>SpringBoot作为项目基础架构</li>
<li>MD5用于用户密码的加密</li>
<li>Jwt用于token的生成和校验</li>
<li>Jackson用于转换JSON</li>
</ul>
<h3 id="功能展示"><a href="#功能展示" class="headerlink" title="功能展示"></a>功能展示</h3><blockquote>
<p>头条首页信息搜索</p>
</blockquote>
<p><img src="/image/image_AEA1JELlwg.png"></p>
<blockquote>
<p>登录功能</p>
</blockquote>
<p><img src="/image/image_tanjgauKKL.png"></p>
<blockquote>
<p>注册功能</p>
</blockquote>
<p><img src="/image/image_UtZ3I_X_Pp.png"></p>
<blockquote>
<p>展示功能</p>
</blockquote>
<p><img src="/image/image_HZ3nuKozDC.png"></p>
<blockquote>
<p>发布头条功能</p>
</blockquote>
<p><img src="/image/image_pD-aiaiz-h.png"></p>
<blockquote>
<p>修改头条功能</p>
</blockquote>
<p><img src="/image/image_dvu1Jbs-mJ.png"></p>
<blockquote>
<p>删除头条功能</p>
</blockquote>
<p><img src="/image/image_H4EHFxNCQa.png"></p>
<h2 id="二、微头条前端搭建"><a href="#二、微头条前端搭建" class="headerlink" title="二、微头条前端搭建"></a>二、微头条前端搭建</h2><blockquote>
<p>确保本地node，npm，vscode安装完毕！ 如果没有安装可以回看ssm整合实战！</p>
</blockquote>
<ul>
<li><p>解压前端项目代码并存放到磁盘的合适位置</p>
<p><a href="file/atguigu-headline_Dx7OqeyleH.rar" title="atguigu-headline.rar">atguigu-headline.rar</a></p>
<p><img src="/image/image_vslTlA9lTP.png"></p>
</li>
<li><p>使用vscode打开工程</p>
<p><img src="/image/image_DLv8kvhW2X.png"></p>
</li>
<li><p>进入项目后打开集成终端或者在src上右击选择在集成终端中打开</p>
<p><img src="/image/image_4e4FtsunND.png"></p>
</li>
<li><p>通过 npm run dev启动前端项目</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install </span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="三、基于SpringBoot搭建项目基础架构"><a href="#三、基于SpringBoot搭建项目基础架构" class="headerlink" title="三、基于SpringBoot搭建项目基础架构"></a>三、基于SpringBoot搭建项目基础架构</h2><h3 id="1-数据库脚本执行"><a href="#1-数据库脚本执行" class="headerlink" title="1. 数据库脚本执行"></a>1. 数据库脚本执行</h3><p>执行数据库脚本:</p>
<p><a href="file/top_news_tOm1rnSjEc.sql" title="top_news.sql">top_news.sql</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE sm_db;</span><br><span class="line"></span><br><span class="line">USE sm_db;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> NAMES utf8mb4;</span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for news_headline</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `news_headline`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `news_headline`  (</span><br><span class="line">  `hid` <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;头条id&#x27;</span>,</span><br><span class="line">  `title` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;头条标题&#x27;</span>,</span><br><span class="line">  `article` <span class="type">VARCHAR</span>(<span class="number">5000</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;头条新闻内容&#x27;</span>,</span><br><span class="line">  `type` <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;头条类型id&#x27;</span>,</span><br><span class="line">  `publisher` <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;头条发布用户id&#x27;</span>,</span><br><span class="line">  `page_views` <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;头条浏览量&#x27;</span>,</span><br><span class="line">  `create_time` DATETIME(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;头条发布时间&#x27;</span>,</span><br><span class="line">  `update_time` DATETIME(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;头条最后的修改时间&#x27;</span>,</span><br><span class="line">  `version` <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span> COMMENT <span class="string">&#x27;乐观锁&#x27;</span>,</span><br><span class="line">  `is_deleted` <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;头条是否被删除 1 删除  0 未删除&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`hid`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> INNODB AUTO_INCREMENT <span class="operator">=</span> <span class="number">1</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_0900_ai_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">DYNAMIC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of news_headline</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;特色产业激发乡村振兴新活力&#x27;</span>, <span class="string">&#x27;推进中国式现代化，必须全面推进乡村振兴。习近平总书记指出，产业振兴是乡村振兴的重中之重，也是实际工作的切入点。近日，记者走进乡村一线，看到各地以特色产业为抓手，拓展产业链发展产业集群，一二三产业融合发展，培育乡村振兴新动能。\n\n　　这个端午，广东茂名高州市根子镇柏桥村的荔枝迎来了丰收。今年4月，习近平总书记来到柏桥村考察调研。总书记走进荔枝种植园，了解当地发展特色种植产业和文旅产业等情况，并同现场技术人员亲切交流。&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:26:20&#x27;</span>, <span class="string">&#x27;2023-06-25 09:26:20&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;北京连续三天最高温超40℃，6月“炎值”因何爆表？&#x27;</span>, <span class="string">&#x27;　中新社北京6月24日电 (记者 陈杭 徐婧)京城连续三日“热晴不减”，且高温红色预警持续生效。截至24日13时51分，作为北京地区气象观测代表站的南郊观象台气温突破40℃，这是该站观测史上首次连续三天气温超40℃。22日以来，北京高温“烤验”突出。22日，北京南郊观象台最高气温达41.1℃，这是有观测纪录以来历史第二高(并列)。北京市气象局表示，观象台1951年建站以来极端最高气温为41.9℃，出现在1999年7月24日。\n\n　　23日，北京南郊观象台最高气温为40.3℃，这是该观象台建站以来首次出现连续两天最高气温超40℃。当天，北京时隔9年再次发布最高级别的高温红色预警信号。&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:28:06&#x27;</span>, <span class="string">&#x27;2023-06-25 09:28:06&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;今年夏天，极端高温是否会成为常态？&#x27;</span>, <span class="string">&#x27;针对京津冀地区持续高温天气，23日下午，中国气象局召开高温天气新闻通气会。\n\n　　刚过6月就出现极端高温天，今年夏天还会有多少高温天呢？对此，国家气候中心首席预报员高辉表示，根据国家气候中心预计，今年夏天全国大部分地区气温都比常年同期要偏高，这也对应着高温日数也要高于常年同期。但不同的地区，高温集中时段不一样，比如南方地区是在盛夏时间段进入高温季，而北方地区往往是在初夏时间段，所以从今年夏季来说，要区分不同的地区来考虑高温的影响。\n\n　　我国各地高温集中时段有明显的地域差异。对华北地区来说，通常雨季前的6月至7月初更容易出现高温天气，连续数天的高温在6月也比较常见。高辉说，这段时间主要是干热型高温为主，表现为气温高湿度小。进入7月后期，随着副高北跳和夏季风往北推进，水汽输送和大气湿度增加，云量也会增多，会出现闷热天气，也就是湿热型高温。就最高气温而言，前一时段气温最高值通常高于后一时段。但也需要说明的是，人体体感温度不仅和气温有关，还受到湿度影响，往往这种湿热型高温会加重人体体感温度。&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:31:00&#x27;</span>, <span class="string">&#x27;2023-06-25 09:31:00&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;中央气象台发布今年首个高温橙色预警&#x27;</span>, <span class="string">&#x27;新华社北京6月22日电（记者黄垚）22日18时，中央气象台升级发布今年首个高温橙色预警。预计23日白天，华北、黄淮等地将继续出现35℃以上的高温天气，北京、天津、河北中南部、山东中北部等地部分地区最高气温可达40℃左右。\n\n　　气象监测显示，22日8时至16时，北京、天津、河北中部、山东北部等地气温上升迅猛，最高气温升至40℃以上。上述4省份共有17个国家气象观测站最高气温突破历史极值。&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:31:36&#x27;</span>, <span class="string">&#x27;2023-06-25 09:31:36&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;江南水乡 龙舟竞渡&#x27;</span>, <span class="string">&#x27;江南水乡 龙舟竞渡---6月18日，浙江省湖州市“我们的节日·端午”暨第七届江南·民当端午民俗文化旅游节在南浔区和孚镇民当村开幕，来自南浔区各个乡镇的农民选手在河道中赛龙舟、划菱桶，体验传统端午民俗。&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:32:13&#x27;</span>, <span class="string">&#x27;2023-06-25 09:32:13&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">6</span>, <span class="string">&#x27;螃蟹粽、印花蛋、艾草凉粉……你知道端午有哪些创意美食吗？&#x27;</span>, <span class="string">&#x27;端午有旅行路上的见闻，有诗画里的艺术，也少不了舌尖上的风韵。听风入夏粽香佐茶，您还知道端午有哪些创意美食吗？端午至味，总少不了粽子这一味。甜的、咸的，肉馅的、蛋黄的、红枣的、豆沙的……一起来寻味端午！\n\n　　古人其实早就喜欢把各种果干放进粽子里，美食家苏轼还发明了杨梅粽。《玉台新咏》中说，“酒中喜桃子，粽里觅杨梅。”后来苏轼曾借用过这个典故，在元祐三年所写的端午帖子中说，“不独盘中见卢橘，时于粽里得杨梅”。&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:32:40&#x27;</span>, <span class="string">&#x27;2023-06-25 09:32:40&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">7</span>, <span class="string">&#x27;尼克斯拒绝执行罗斯球队选项 罗斯成自由球员&#x27;</span>, <span class="string">&#x27;北京时间6月25日，据多方消息源报道，尼克斯拒绝执行德里克-罗斯下赛季的球队选项，罗斯成为完全自由球员。\n\n　　34岁的罗斯在刚刚结束的赛季队内角色严重下滑，他仅出战27场比赛，场均登场12.5分钟，得到5.6分1.5篮板1.7助攻。\n\n　　2021年，罗斯与尼克斯签下3年4300万美元的续约合同，其中最后一年为1560万美元球队选项。&#x27;</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:34:26&#x27;</span>, <span class="string">&#x27;2023-06-25 09:34:26&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">8</span>, <span class="string">&#x27;班凯罗承诺代表美国男篮打世界杯 名单仅差1人&#x27;</span>, <span class="string">&#x27;北京时间6月25日，据著名NBA记者沙姆斯-查拉尼亚报道，魔术前锋保罗-班凯罗承诺将代表美国男篮参加2023年男篮世界杯。\n\n　　班凯罗在刚刚结束的赛季场均能够砍下20.0分6.9篮板3.7助攻，获得了NBA2022-23赛季年度最佳新秀。&#x27;</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:34:59&#x27;</span>, <span class="string">&#x27;2023-06-25 09:34:59&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">9</span>, <span class="string">&#x27;F1加拿大大奖赛正赛：维斯塔潘冠军 阿隆索亚军&#x27;</span>, <span class="string">&#x27;2023年F1加拿大大奖赛正式比赛结束。红牛车队维斯塔潘杆位发车一路轻松领跑，再次完成了Pole-to-Win！这是红牛车队历史上的第100座分站冠军！同时也是维斯塔潘F1生涯的第41座分站冠军，追平了“车神”埃尔顿·塞纳的冠军数！阿斯顿马丁车队阿隆索亚军，梅赛德斯车队汉密尔顿季军。&#x27;</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:35:43&#x27;</span>, <span class="string">&#x27;2023-06-25 09:35:43&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">10</span>, <span class="string">&#x27;CTCC绍兴柯桥站圆满落幕 张志强曹宏炜各取一冠&#x27;</span>, <span class="string">&#x27;6月24日，2023赛季CTCC中国汽车场地职业联赛绍兴柯桥站在雨中的浙江国际赛车场上演了两回合决赛的巅峰角逐。在线上线下观众的共同见证下，超级杯-TCR中国系列赛、运动杯-长三角赛车节联袂献上高水平对决，以精彩的比赛献礼这个端午节假期！TCR 中国系列赛第三回合于今天上午率先开战。来自壳牌捷凯领克车队的张志强穿云破雾夺得冠军；夺得该回合亚军的是驾驶新赛车出战的东风本田车手高度，季军则由Z.SPEED N车队的张臻东斩获。这也是超级杯四冠王本赛季首次登台。&#x27;</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:36:18&#x27;</span>, <span class="string">&#x27;2023-06-25 09:36:18&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">11</span>, <span class="string">&#x27;国象联赛常规赛收兵：杭州银行第一 山东成功上岸&#x27;</span>, <span class="string">&#x27;6月17日，“武陵山大裂谷杯”中国国际象棋甲级联赛常规赛在武陵云海国际酒店进行了最后一轮的争夺，杭州银行弈和山东队，抢到常规赛的冠军；山东队也是凭借这场平局，成功脱离保级区。本轮最大的悬念是第八名的争夺——在年底进行的甲级联赛总决赛中，前八名为上半区争冠组，保级无忧；而第九至十二名为保级区，不仅夺冠无望，还要为保级而苦战。&#x27;</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:36:51&#x27;</span>, <span class="string">&#x27;2023-06-25 09:36:51&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">12</span>, <span class="string">&#x27;围棋名宿解读高考作文:人生如棋 要先学会下“本手”&#x27;</span>, <span class="string">&#x27;今年高考开考了，在语文考试后，体育借势冲上了社交媒体的热搜榜。奥运相关话题进入高考，是意料之中。不过当记者看到关于围棋术语“本手、妙手和俗手”的作文命题时，着实觉得有些难。在被迅速刷屏的朋友圈里，记者感受到了很多从业者的激动、兴奋乃至油然而生的自豪感。但也有人则为那些没学过棋的孩子感到担心，这么难的题目，究竟该如何解题？\n\n　　“围棋正在深入人心。题目有些难，‘俗手’如何定义？但确实应该先下好‘本手’。”翻到中国围棋协会副主席、国家围棋队领队华学明的这条朋友圈动态时，记者瞬间觉得这道公认的难题有了解题的思路。正如高考作文材料中所说，本手是基础。只有持之以恒地打好基础，补强短板，守住不发生系统性风险的底线，才有可能在本手的基础上，下出妙手，避免俗手。而如果脱离了基础，所谓的妙手很可能就是花拳绣腿，经不起推敲，更经不起对手的冲击。世界冠军柯洁表示：“很多人在对局中经常会拘泥于局部，下出假妙手。想下出真正的妙手，必须在平日里有一定的经验积累和训练，才可能完成真正卓越的妙手。”人生如棋，棋如人生。“其实人生中大部分时间都是在下本手”，围棋名宿曹大元九段说。&#x27;</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:37:43&#x27;</span>, <span class="string">&#x27;2023-06-25 09:37:43&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">13</span>, <span class="string">&#x27;不甘人后：被生成式AI弥漫的亚马逊&#x27;</span>, <span class="string">&#x27;今年早些时候，随着ChatGPT席卷全球，亚马逊的经理们要求员工开动脑筋，想想如何使用人工智能（AI）聊天机器人技术来改进自家产品和工作流程。\n\n　　其中一些想法被分享在一份名为《生成式AI——ChatGPT的影响和机会分析》的内部文件中。这份文件共列了ChatGPT和类似应用程序在亚马逊多个团队中的67个潜在应用案例。\n\n　　早在20世纪90年代，亚马逊就靠在网上卖书创造了互联网界首个真正的商业奇迹。\n\n　　随后，Kindle阅读器带来革命性体验，Alexa和Echo智能音箱又带来了语音计算，而AWS则创造了云计算行业，ChatGPT就运行在这个行业之上。\n\n　　但这次热潮中拿到先发优势的是同为科技大厂的微软。微软现在是OpenAI背后的金主，且还在忙着把ChatGPT的底层技术融进微软产品和服务中。&#x27;</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:40:20&#x27;</span>, <span class="string">&#x27;2023-06-25 09:40:20&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">14</span>, <span class="string">&#x27;微创新超实用：米家旅行箱居然想到了这一点&#x27;</span>, <span class="string">&#x27;旅行说走就走，除非老板没安排。名义上是旅游，实则执行任务，对内讲“为公司负重前行”，对外称“带薪游山玩水”，一介打工人，两副扑克脸，个中苦乐谁人知！\n\n“差旅人”精明如我，随身携带更偏向实用。\n\n必备日用之外，能路上买的尽量不带，华而不实的东西，往包里多塞一个都算我输。行李箱尺寸自然也要浓缩到小巧但够装的20英寸，拉着轻松又顺手，常用小物件转移到背包，“轻装上战场”。&#x27;</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:41:04&#x27;</span>, <span class="string">&#x27;2023-06-25 09:41:04&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">15</span>, <span class="string">&#x27;小鹏G6动态试驾：辅助驾驶很惊喜&#x27;</span>, <span class="string">&#x27;这次我们开着小鹏G6上了赛道，又体验了最新版本的高速NGP和城市NGP，小鹏，还顺便测了下充电速度，那么小鹏G6驾驶感受如何？辅助驾驶表现怎么样？&#x27;</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:42:07&#x27;</span>, <span class="string">&#x27;2023-06-25 09:42:07&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">16</span>, <span class="string">&#x27;养车市场陷入低价内卷，“虎猫狗”还没等到春天&#x27;</span>, <span class="string">&#x27;今年“618”期间，汽车后市场的玩家们都打出了“低价牌”。比如途虎养车宣布推出“6.18全民养车季”活动，在此期间北京车主可享受“轮胎买一送一”以及多品牌轮胎降价促销的活动。\n\n　　与此同时，京东养车和天猫养车两大大厂玩家，在本次618期间也喊出了各自的营销口号。\n\n　　前者不仅喊出了“养车爱车立省不止30%”的口号，还推出了轮胎、保养买贵赔两倍、“轮胎免费装、三年无忧质保”、5公里无服务门店赔双倍安装费等举措；天猫养车的618活动，则覆盖了更大的零部件范围，比如推出了空调清洗、机油和轮胎更换等低价服务。\n\n　　这样看，在本次618期间，途虎养车、京东养车和天猫养车均贯彻着“以价换量”的战略，以至于让行业价格战一触即发。这些玩家会这样做，主要是为了与传统4S店、以及与彼此竞争，以便保证自身获得更多的市场份额。&#x27;</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:42:51&#x27;</span>, <span class="string">&#x27;2023-06-25 09:42:51&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">17</span>, <span class="string">&#x27;微软股价历史新高 聊天机器人技术潜力显现&#x27;</span>, <span class="string">&#x27;周四，微软股价创下历史新高，成为今年继英伟达和苹果之后，又一家市值达到新高点的大型科技公司。这家软件巨头正致力于在其产品和服务中添加生成式人工智能功能，旨在全面改造其Office产品阵容，其中包括Excel、PowerPoint、Outlook和Word等。股价上涨3.2%，收于每股348.1美元，为2021年11月19日以来的最高收盘价。自今年初起，微软股价累计上涨了45%，市值增加约8006亿美元。微软持有OpenAI的大部分股份，这家初创公司凭借聊天机器人ChatGPT引发生成式人工智能的热潮。近几个月来，该工具广受欢迎，展示了聊天机器人技术所具有的巨大潜力。微软于今年1月宣布将再向OpenAI投资100亿美元。然而有报道称，微软与OpenAI之间既有合作，亦存竞争，这种特殊的双重关系导致了双方关系的紧张和潜在冲突。科技股如英伟达等同样受益于生成式人工智能技术的应用，各公司将此技术融入各自产品，进而推动相关芯片需求。英伟达股价今年已飙升192%，被视为最大赢家。&#x27;</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:43:48&#x27;</span>, <span class="string">&#x27;2023-06-25 09:43:48&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_headline` (hid,title,article,TYPE,publisher,page_views,create_time,update_time,is_deleted) <span class="keyword">VALUES</span> (<span class="number">18</span>, <span class="string">&#x27;再获11亿美元投资：蔚来“长期主义”的底气&#x27;</span>, <span class="string">&#x27;如果说全系降价3万是李斌的“阳谋”，那么蔚来ET5T的发布，则是李斌的又一次诚意之作。\n\n　　ET5T是蔚来首款售价下探到30万元以下的新车，作为ET5的姐妹车型，ET5T和ET5的双车合璧，得以在30万以下快速开疆辟土。\n\n　　这样的做法有迹可循：特斯拉曾经在Model Y上实践过，并大获成功。\n\n　　Model Y和Model 3共用平台，零部件复用率高达75%，研发成本骤降。尽管Model Y最初被用户吐槽是Model 3的放大版，但不置可否的是Model Y确实解决了用户对Model 3空间不足的槽点。\n\n　　不过，最为关键的还是Model Y的价格足够低，直接降低了特斯拉的购买门槛，给那些对价格敏感，本犹豫要不要多花四五万的消费者一个充足的理由。\n\n　　蔚来ET5T正在用一种经受了市场验证过的方式，直面与特斯拉的竞争。但同时，蔚来ET5T在智能化、空间表现、设计以及产品力上，都正在接近、超越特斯拉Model Y。\n\n　　蔚来ET5T，平替特斯拉Model Y？\n\n　　小家庭，预算30万左右，消费者到底会选哪款纯电动车？\n\n　　全球市场的反馈是，特斯拉Model Y ——一款紧凑型SUV。2022年，Model Y的全球销量为74.7万辆，其在中国的销量为31.5万台，约占其全球份额的42.2%。\n\n　　按照车型大小，SUV可以分为大型、中型、小型、紧凑型四大类。按照价位，SUV又可以分为实用型、经济型、中高档型、豪华型、超豪华型等。\n\n　　Model Y 在中高端SUV的细分市场中一骑绝尘，可以说是没有对手。因为无论是奔驰EQC、宝马iX3，还是国产的比亚迪唐EV等，和Model Y相比，都不能对其构成威胁。奔驰EQC、宝马iX3这两款车型都是“油改电”，算不上真正的电动车。而比亚迪的智能化能力，远及不特斯拉，座舱、智驾上的核心模块还来自于供应商方案，并非自研。\n\n　　雷峰网认为，此前，国内的自主品牌中只有蔚来的ES6能和Model Y一较高下。不过ES6的均价比Model Y高出一大截，二者入门版之间的价差大约在10万左右。但在蔚来推出ET5T后，局势必然会发生逆转。&#x27;</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="string">&#x27;2023-06-25 09:44:20&#x27;</span>, <span class="string">&#x27;2023-06-25 09:44:20&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for news_type</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `news_type`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `news_type`  (</span><br><span class="line">  `tid` <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;新闻类型id&#x27;</span>,</span><br><span class="line">  `tname` <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;新闻类型描述&#x27;</span>,</span><br><span class="line">  `version` <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span> COMMENT <span class="string">&#x27;乐观锁&#x27;</span>,</span><br><span class="line">  `is_deleted` <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;头条是否被删除 1 删除  0 未删除&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`tid`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> INNODB AUTO_INCREMENT <span class="operator">=</span> <span class="number">8</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_0900_ai_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">DYNAMIC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of news_type</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_type` (tid,tname) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;新闻&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_type` (tid,tname) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;体育&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_type` (tid,tname) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;娱乐&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_type` (tid,tname) <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;科技&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_type` (tid,tname) <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;其他&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for news_user</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `news_user`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `news_user`  (</span><br><span class="line">  `uid` <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;用户id&#x27;</span>,</span><br><span class="line">  `username` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户登录名&#x27;</span>,</span><br><span class="line">  `user_pwd` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户登录密码密文&#x27;</span>,</span><br><span class="line">  `nick_name` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户昵称&#x27;</span>,</span><br><span class="line">  `version` <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span> COMMENT <span class="string">&#x27;乐观锁&#x27;</span>,</span><br><span class="line">  `is_deleted` <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;头条是否被删除 1 删除  0 未删除&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`uid`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">  <span class="keyword">UNIQUE</span> INDEX `username_unique`(`username`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> INNODB AUTO_INCREMENT <span class="operator">=</span> <span class="number">9</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_0900_ai_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">DYNAMIC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of news_user</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_user` (uid,username,user_pwd,nick_name) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;zhangsan&#x27;</span>, <span class="string">&#x27;e10adc3949ba59abbe56e057f20f883e&#x27;</span>, <span class="string">&#x27;张三&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_user` (uid,username,user_pwd,nick_name) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;lisi&#x27;</span>, <span class="string">&#x27;e10adc3949ba59abbe56e057f20f883e&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_user` (uid,username,user_pwd,nick_name) <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;zhangxiaoming&#x27;</span>, <span class="string">&#x27;e10adc3949ba59abbe56e057f20f883e&#x27;</span>, <span class="string">&#x27;张小明&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `news_user` (uid,username,user_pwd,nick_name)<span class="keyword">VALUES</span> (<span class="number">6</span>, <span class="string">&#x27;xiaohei&#x27;</span>, <span class="string">&#x27;e10adc3949ba59abbe56e057f20f883e&#x27;</span>, <span class="string">&#x27;李小黑&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-搭建SprintBoot工程"><a href="#2-搭建SprintBoot工程" class="headerlink" title="2. 搭建SprintBoot工程"></a>2. 搭建SprintBoot工程</h3><ol>
<li><p>创建boot工程</p>
</li>
<li><p>导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.atguigu<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot-headline<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>17<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment">&lt;!-- mybatis-plus  --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment">&lt;!-- 数据库相关配置启动器 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment">&lt;!-- druid启动器的依赖  --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-3-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.18<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment">&lt;!-- 驱动类--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--    SpringBoot应用打包插件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3.  编写配置</span><br><span class="line"></span><br><span class="line">    application.yaml</span><br><span class="line">    ```yaml</span><br><span class="line">    # server配置</span><br><span class="line">    server:</span><br><span class="line">      port: 8080</span><br><span class="line">      servlet:</span><br><span class="line">        context-path: /</span><br><span class="line">    </span><br><span class="line">    # 连接池配置</span><br><span class="line">    spring:</span><br><span class="line">      datasource:</span><br><span class="line">        type: com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">        druid:</span><br><span class="line">          url: jdbc:mysql:///sm_db1</span><br><span class="line">          username: root</span><br><span class="line">          password: root</span><br><span class="line">          driver-class-name: com.mysql.cj.jdbc.Driver</span><br><span class="line">    </span><br><span class="line">    # mybatis-plus的配置</span><br><span class="line">    mybatis-plus:</span><br><span class="line">      type-aliases-package: com.atguigu.pojo</span><br><span class="line">      global-config:</span><br><span class="line">        db-config:</span><br><span class="line">          logic-delete-field: isDeleted  #全局逻辑删除</span><br><span class="line">          id-type: auto #主键策略自增长</span><br><span class="line">          table-prefix: news_ # 设置表的前缀</span><br></pre></td></tr></table></figure></li>
<li><p>druid兼容springboot3文件</p>
<p><img src="/image/image_xIwwJ7Z2TM.png"></p>
<p>文件名和内容</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">文件名:org.springframework.boot.autoconfigure.AutoConfiguration.imports</span></span><br><span class="line"><span class="string">内容:com.alibaba.druid.spring.boot3.autoconfigure.DruidDataSourceAutoConfigure</span></span><br></pre></td></tr></table></figure></li>
<li><p>启动类和mybatis-plus配置</p>
<p>包: com.atguigu</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.atguigu.mapper&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Main.class,args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置mybatis-plus插件</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>(DbType.MYSQL)); <span class="comment">//分页</span></span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">OptimisticLockerInnerInterceptor</span>());  <span class="comment">//乐观锁</span></span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">BlockAttackInnerInterceptor</span>());  <span class="comment">//防全局修改和删除</span></span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>工具类准备</p>
<p>结果封装类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 全局统一返回结果类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Result</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="comment">// 返回码</span></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line">    <span class="comment">// 返回消息</span></span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    <span class="comment">// 返回数据</span></span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Result</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    <span class="comment">// 返回数据</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">build</span><span class="params">(T data)</span> &#123;</span><br><span class="line">        Result&lt;T&gt; result = <span class="keyword">new</span> <span class="title class_">Result</span>&lt;T&gt;();</span><br><span class="line">        <span class="keyword">if</span> (data != <span class="literal">null</span>)</span><br><span class="line">            result.setData(data);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">build</span><span class="params">(T body, Integer code, String message)</span> &#123;</span><br><span class="line">        Result&lt;T&gt; result = build(body);</span><br><span class="line">        result.setCode(code);</span><br><span class="line">        result.setMessage(message);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">build</span><span class="params">(T body, ResultCodeEnum resultCodeEnum)</span> &#123;</span><br><span class="line">        Result&lt;T&gt; result = build(body);</span><br><span class="line">        result.setCode(resultCodeEnum.getCode());</span><br><span class="line">        result.setMessage(resultCodeEnum.getMessage());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 操作成功</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data  baseCategory1List</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>&lt;T&gt; Result&lt;T&gt; <span class="title function_">ok</span><span class="params">(T data)</span>&#123;</span><br><span class="line">        Result&lt;T&gt; result = build(data);</span><br><span class="line">        <span class="keyword">return</span> build(data, ResultCodeEnum.SUCCESS);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Result&lt;T&gt; <span class="title function_">message</span><span class="params">(String msg)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.setMessage(msg);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Result&lt;T&gt; <span class="title function_">code</span><span class="params">(Integer code)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.setCode(code);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCode</span><span class="params">(Integer code)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMessage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">getData</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setData</span><span class="params">(T data)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>解决枚举类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 统一返回结果状态信息类</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">ResultCodeEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    SUCCESS(<span class="number">200</span>,<span class="string">&quot;success&quot;</span>),</span><br><span class="line">    USERNAME_ERROR(<span class="number">501</span>,<span class="string">&quot;usernameError&quot;</span>),</span><br><span class="line">    PASSWORD_ERROR(<span class="number">503</span>,<span class="string">&quot;passwordError&quot;</span>),</span><br><span class="line">    NOTLOGIN(<span class="number">504</span>,<span class="string">&quot;notLogin&quot;</span>),</span><br><span class="line">    USERNAME_USED(<span class="number">505</span>,<span class="string">&quot;userNameUsed&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">ResultCodeEnum</span><span class="params">(Integer code, String message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>MD5加密工具类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">MD5Util</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encrypt</span><span class="params">(String strSrc)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">char</span> hexChars[] = &#123; <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span> &#125;;</span><br><span class="line">            <span class="type">byte</span>[] bytes = strSrc.getBytes();</span><br><span class="line">            <span class="type">MessageDigest</span> <span class="variable">md</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">            md.update(bytes);</span><br><span class="line">            bytes = md.digest();</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> bytes.length;</span><br><span class="line">            <span class="type">char</span>[] chars = <span class="keyword">new</span> <span class="title class_">char</span>[j * <span class="number">2</span>];</span><br><span class="line">            <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; bytes.length; i++) &#123;</span><br><span class="line">                <span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> bytes[i];</span><br><span class="line">                chars[k++] = hexChars[b &gt;&gt;&gt; <span class="number">4</span> &amp; <span class="number">0xf</span>];</span><br><span class="line">                chars[k++] = hexChars[b &amp; <span class="number">0xf</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(chars);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;MD5加密出错！！+&quot;</span> + e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="3-MybatisX逆向工程"><a href="#3-MybatisX逆向工程" class="headerlink" title="3. MybatisX逆向工程"></a>3. MybatisX逆向工程</h3><ol>
<li><p>逆向工程</p>
<p><img src="/image/image_kxo8e0mx90.png"></p>
<p><img src="/image/image_ZU10-oHDap.png"></p>
<p><img src="/image/image_TVundRSFu4.png"></p>
</li>
<li><p>完善实体类注解</p>
<p>删除tableName注解,全局统一设置</p>
<p>添加主键,乐观锁,逻辑删除注解!!!</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@TableId</span></span><br><span class="line">    <span class="keyword">private</span> Integer uid;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userPwd;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String nickName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Version</span></span><br><span class="line">    <span class="keyword">private</span> Integer version;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableLogic</span></span><br><span class="line">    <span class="keyword">private</span> Integer isDeleted;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="四、后台功能开发"><a href="#四、后台功能开发" class="headerlink" title="四、后台功能开发"></a>四、后台功能开发</h2><h3 id="4-1-用户模块开发"><a href="#4-1-用户模块开发" class="headerlink" title="4.1 用户模块开发"></a>4.1 用户模块开发</h3><ul>
<li><p><strong>1.1  jwt和token介绍</strong></p>
<ol>
<li><p>token介绍</p>
<p>令牌（Token）：在计算机领域，令牌是一种代表某种访问权限或身份认证信息的令牌。它可以是一串随机生成的字符或数字，用于验证用户的身份或授权用户对特定资源的访问。普通的令牌可能以各种形式出现，如访问令牌、身份令牌、刷新令牌等。</p>
<p><img src="/image/image_ezWGkcz3-q.png"></p>
<p>简单理解 : 每个用户生成的唯一字符串标识,可以进行用户识别和校验</p>
<p>类似技术:  天王盖地虎 ,小鸡炖蘑菇</p>
<p>优势: token验证标识无法直接识别用户的信息,盗取token后也无法`登录`程序! 相对安全!</p>
</li>
<li><p>jwt介绍</p>
<p>Token是一项规范和标准(接口)</p>
<p>JWT(JSON Web Token)是具体可以生成,校验,解析等动作Token的技术(实现类)</p>
<p><img src="/image/image_tyJl6YQaLO.png"></p>
</li>
<li><p>jwt工作流程</p>
<ul>
<li>用户提供其凭据（通常是用户名和密码）进行身份验证。</li>
<li>服务器对这些凭据进行验证，并在验证成功后创建一个JWT。</li>
<li>服务器将JWT发送给客户端，并客户端在后续的请求中将JWT附加在请求头或参数中。</li>
<li>服务器接收到请求后，验证JWT的签名和有效性，并根据JWT中的声明进行身份验证和授权操作</li>
</ul>
</li>
<li><p>jwt数据组成和包含信息</p>
<p>JWT由三部分组成: header(头部).payload(载荷).signature(签名)</p>
<p><img src="/image/image_BN9CiapOe7.png"></p>
<p>我们需要理解的是, jwt可以携带很多信息! 一般情况,需要加入:有效时间,签名秘钥,其他用户标识信息!</p>
<p>有效时间为了保证token的时效性,过期可以重新登录获取!</p>
<p>签名秘钥为了防止其他人随意解析和校验token数据!</p>
<p>用户信息为了我们自己解析的时候,知道Token对应的具体用户!</p>
</li>
<li><p>jwt使用和测试</p>
<ol>
<li><p>导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.jsonwebtoken<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jjwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.xml.bind<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jaxb-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>编写配置</p>
<p>application.yaml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#jwt配置</span></span><br><span class="line"><span class="attr">jwt:</span></span><br><span class="line">  <span class="attr">token:</span></span><br><span class="line">    <span class="attr">tokenExpiration:</span> <span class="number">120</span> <span class="comment">#有效时间,单位分钟</span></span><br><span class="line">    <span class="attr">tokenSignKey:</span> <span class="string">headline123456</span>  <span class="comment">#当前程序签名秘钥 自定义</span></span><br></pre></td></tr></table></figure></li>
<li><p>导入工具类</p>
<p>封装jwt技术工具类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">     <span class="keyword">package</span> com.atguigu.utils;</span><br><span class="line">     </span><br><span class="line">     <span class="keyword">import</span> com.alibaba.druid.util.StringUtils;</span><br><span class="line">     <span class="keyword">import</span> io.jsonwebtoken.*;</span><br><span class="line">     <span class="keyword">import</span> lombok.Data;</span><br><span class="line">     <span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line">     <span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line">     <span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line">     </span><br><span class="line">     <span class="keyword">import</span> java.util.Date;</span><br><span class="line">     </span><br><span class="line">     <span class="meta">@Data</span></span><br><span class="line">     <span class="meta">@Component</span></span><br><span class="line">     <span class="meta">@ConfigurationProperties(prefix = &quot;jwt.token&quot;)</span></span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JwtHelper</span> &#123;</span><br><span class="line">     </span><br><span class="line">         <span class="keyword">private</span>  <span class="type">long</span> tokenExpiration; <span class="comment">//有效时间,单位毫秒 1000毫秒 == 1秒</span></span><br><span class="line">         <span class="keyword">private</span>  String tokenSignKey;  <span class="comment">//当前程序签名秘钥</span></span><br><span class="line">     </span><br><span class="line">         <span class="comment">//生成token字符串</span></span><br><span class="line">         <span class="keyword">public</span>  String <span class="title function_">createToken</span><span class="params">(Long userId)</span> &#123;</span><br><span class="line">             System.out.println(<span class="string">&quot;tokenExpiration = &quot;</span> + tokenExpiration);</span><br><span class="line">             System.out.println(<span class="string">&quot;tokenSignKey = &quot;</span> + tokenSignKey);</span><br><span class="line">             <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> Jwts.builder()</span><br><span class="line">     </span><br><span class="line">                     .setSubject(<span class="string">&quot;YYGH-USER&quot;</span>)</span><br><span class="line">                     .setExpiration(<span class="keyword">new</span> <span class="title class_">Date</span>(System.currentTimeMillis() + tokenExpiration*<span class="number">1000</span>*<span class="number">60</span>)) <span class="comment">//单位分钟</span></span><br><span class="line">                     .claim(<span class="string">&quot;userId&quot;</span>, userId)</span><br><span class="line">                     .signWith(SignatureAlgorithm.HS512, tokenSignKey)</span><br><span class="line">                     .compressWith(CompressionCodecs.GZIP)</span><br><span class="line">                     .compact();</span><br><span class="line">             <span class="keyword">return</span> token;</span><br><span class="line">         &#125;</span><br><span class="line">     </span><br><span class="line">         <span class="comment">//从token字符串获取userid</span></span><br><span class="line">         <span class="keyword">public</span>  Long <span class="title function_">getUserId</span><span class="params">(String token)</span> &#123;</span><br><span class="line">             <span class="keyword">if</span>(StringUtils.isEmpty(token)) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">             Jws&lt;Claims&gt; claimsJws = Jwts.parser().setSigningKey(tokenSignKey).parseClaimsJws(token);</span><br><span class="line">             <span class="type">Claims</span> <span class="variable">claims</span> <span class="operator">=</span> claimsJws.getBody();</span><br><span class="line">             <span class="type">Integer</span> <span class="variable">userId</span> <span class="operator">=</span> (Integer)claims.get(<span class="string">&quot;userId&quot;</span>);</span><br><span class="line">             <span class="keyword">return</span> userId.longValue();</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="comment">//判断token是否有效</span></span><br><span class="line">                 <span class="keyword">public</span>  <span class="type">boolean</span> <span class="title function_">isExpiration</span><span class="params">(String token)</span>&#123;</span><br><span class="line">                     <span class="keyword">try</span> &#123;</span><br><span class="line">                         <span class="type">boolean</span> <span class="variable">isExpire</span> <span class="operator">=</span> Jwts.parser()</span><br><span class="line">                                 .setSigningKey(tokenSignKey)</span><br><span class="line">                                 .parseClaimsJws(token)</span><br><span class="line">                                 .getBody()</span><br><span class="line">                                 .getExpiration().before(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">                         <span class="comment">//没有过期，有效，返回false</span></span><br><span class="line">                         <span class="keyword">return</span> isExpire;</span><br><span class="line">                     &#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">                         <span class="comment">//过期出现异常，返回true</span></span><br><span class="line">                         <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                     &#125;</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">     </span><br><span class="line">    </span><br><span class="line"><span class="number">4.</span> 使用和测试</span><br><span class="line">    </span><br><span class="line">   ```java</span><br><span class="line">   <span class="meta">@SpringBootTest</span></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringBootTest</span> &#123;</span><br><span class="line">   </span><br><span class="line">           <span class="meta">@Autowired</span></span><br><span class="line">           <span class="keyword">private</span> JwtHelper jwtHelper;</span><br><span class="line">   </span><br><span class="line">           <span class="meta">@Test</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">               <span class="comment">//生成 传入用户标识</span></span><br><span class="line">               <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> jwtHelper.createToken(<span class="number">1L</span>);</span><br><span class="line">               System.out.println(<span class="string">&quot;token = &quot;</span> + token);</span><br><span class="line">   </span><br><span class="line">               <span class="comment">//解析用户标识</span></span><br><span class="line">               <span class="type">int</span> <span class="variable">userId</span> <span class="operator">=</span> jwtHelper.getUserId(token).intValue();</span><br><span class="line">               System.out.println(<span class="string">&quot;userId = &quot;</span> + userId);</span><br><span class="line">   </span><br><span class="line">               <span class="comment">//校验是否到期! false 未到期 true到期</span></span><br><span class="line">               <span class="type">boolean</span> <span class="variable">expiration</span> <span class="operator">=</span> jwtHelper.isExpiration(token);</span><br><span class="line">               System.out.println(<span class="string">&quot;expiration = &quot;</span> + expiration);</span><br><span class="line">           &#125;</span><br><span class="line">   </span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
<li><p><strong>1.2  登录功能实现</strong></p>
<ol>
<li><p>需求描述</p>
<p><img src="/image/1687657661761_AB9lALvt6R.png"></p>
<p>用户在客户端输入用户名密码并向后端提交,后端根据用户名和密码判断登录是否成功,用户有误或者密码有误响应不同的提示信息！</p>
</li>
<li><p>接口描述</p>
<p>url地址： user&#x2F;login</p>
<p>请求方式：POST</p>
<p>请求参数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>:<span class="string">&quot;zhangsan&quot;</span>, <span class="comment">//用户名</span></span><br><span class="line">    <span class="string">&quot;userPwd&quot;</span>:<span class="string">&quot;123456&quot;</span>     <span class="comment">//明文密码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>响应数据：</p>
<p>成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="string">&quot;code&quot;</span>:<span class="string">&quot;200&quot;</span>,         <span class="comment">// 成功状态码 </span></span><br><span class="line">   <span class="string">&quot;message&quot;</span>:<span class="string">&quot;success&quot;</span>   <span class="comment">// 成功状态描述</span></span><br><span class="line">   <span class="string">&quot;data&quot;</span>:&#123;</span><br><span class="line">    <span class="string">&quot;token&quot;</span>:<span class="string">&quot;... ...&quot;</span> <span class="comment">// 用户id的token</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>失败</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="string">&quot;code&quot;</span>:<span class="string">&quot;501&quot;</span>,</span><br><span class="line">   <span class="string">&quot;message&quot;</span>:<span class="string">&quot;用户名有误&quot;</span></span><br><span class="line">   <span class="string">&quot;data&quot;</span>:&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="string">&quot;code&quot;</span>:<span class="string">&quot;503&quot;</span>,</span><br><span class="line">   <span class="string">&quot;message&quot;</span>:<span class="string">&quot;密码有误&quot;</span></span><br><span class="line">   <span class="string">&quot;data&quot;</span>:&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>实现代码</p>
<ol>
<li>controller<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@RestController</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;user&quot;)</span></span><br><span class="line">    <span class="meta">@CrossOrigin</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">        <span class="meta">@Autowired</span></span><br><span class="line">                <span class="keyword">private</span> UserService userService;</span><br><span class="line">    </span><br><span class="line">                <span class="comment">/**</span></span><br><span class="line"><span class="comment">                 * 登录需求</span></span><br><span class="line"><span class="comment">                 * 地址: /user/login</span></span><br><span class="line"><span class="comment">                 * 方式: post</span></span><br><span class="line"><span class="comment">                 * 参数:</span></span><br><span class="line"><span class="comment">                 *    &#123;</span></span><br><span class="line"><span class="comment">                 *     &quot;username&quot;:&quot;zhangsan&quot;, //用户名</span></span><br><span class="line"><span class="comment">                 *     &quot;userPwd&quot;:&quot;123456&quot;     //明文密码</span></span><br><span class="line"><span class="comment">                 *    &#125;</span></span><br><span class="line"><span class="comment">                 * 返回:</span></span><br><span class="line"><span class="comment">                 *   &#123;</span></span><br><span class="line"><span class="comment">                 *    &quot;code&quot;:&quot;200&quot;,         // 成功状态码</span></span><br><span class="line"><span class="comment">                 *    &quot;message&quot;:&quot;success&quot;   // 成功状态描述</span></span><br><span class="line"><span class="comment">                 *    &quot;data&quot;:&#123;</span></span><br><span class="line"><span class="comment">                 *         &quot;token&quot;:&quot;... ...&quot; // 用户id的token</span></span><br><span class="line"><span class="comment">                 *     &#125;</span></span><br><span class="line"><span class="comment">                 *  &#125;</span></span><br><span class="line"><span class="comment">                 *</span></span><br><span class="line"><span class="comment">                 * 大概流程:</span></span><br><span class="line"><span class="comment">                 *    1. 账号进行数据库查询 返回用户对象</span></span><br><span class="line"><span class="comment">                 *    2. 对比用户密码(md5加密)</span></span><br><span class="line"><span class="comment">                 *    3. 成功,根据userId生成token -&gt; map key=token value=token值 - result封装</span></span><br><span class="line"><span class="comment">                 *    4. 失败,判断账号还是密码错误,封装对应的枚举错误即可</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                <span class="meta">@PostMapping(&quot;login&quot;)</span></span><br><span class="line">                <span class="keyword">public</span> Result <span class="title function_">login</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span>&#123;</span><br><span class="line">                    <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> userService.login(user);</span><br><span class="line">                    System.out.println(<span class="string">&quot;result = &quot;</span> + result);</span><br><span class="line">                    <span class="keyword">return</span> result;</span><br><span class="line">                &#125;</span><br><span class="line">    </span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>  service</span><br><span class="line"></span><br><span class="line">   ```java</span><br><span class="line">   <span class="meta">@Service</span></span><br><span class="line">           <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper, User&gt;</span><br><span class="line">               <span class="keyword">implements</span> <span class="title class_">UserService</span>&#123;</span><br><span class="line">               <span class="meta">@Autowired</span></span><br><span class="line">               <span class="keyword">private</span> JwtHelper jwtHelper;</span><br><span class="line">               <span class="meta">@Autowired</span></span><br><span class="line">               <span class="keyword">private</span>  UserMapper userMapper;</span><br><span class="line">   </span><br><span class="line">               <span class="comment">/**</span></span><br><span class="line"><span class="comment">                * 登录业务实现</span></span><br><span class="line"><span class="comment">                * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">                * <span class="doctag">@return</span> result封装</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">               <span class="meta">@Override</span></span><br><span class="line">               <span class="keyword">public</span> Result <span class="title function_">login</span><span class="params">(User user)</span> &#123;</span><br><span class="line">   </span><br><span class="line">                   <span class="comment">//根据账号查询</span></span><br><span class="line">                   LambdaQueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">                   queryWrapper.eq(User::getUsername,user.getUsername());</span><br><span class="line">                   <span class="type">User</span> <span class="variable">loginUser</span> <span class="operator">=</span> userMapper.selectOne(queryWrapper);</span><br><span class="line">   </span><br><span class="line">                   <span class="comment">//账号判断</span></span><br><span class="line">                   <span class="keyword">if</span> (loginUser == <span class="literal">null</span>) &#123;</span><br><span class="line">                       <span class="comment">//账号错误</span></span><br><span class="line">                       <span class="keyword">return</span> Result.build(<span class="literal">null</span>, ResultCodeEnum.USERNAME_ERROR);</span><br><span class="line">                   &#125;</span><br><span class="line">   </span><br><span class="line">                   <span class="comment">//判断密码</span></span><br><span class="line">                   <span class="keyword">if</span> (!StringUtils.isEmpty(user.getUserPwd())</span><br><span class="line">                           &amp;&amp; loginUser.getUserPwd().equals(MD5Util.encrypt(user.getUserPwd())))</span><br><span class="line">                   &#123;</span><br><span class="line">                      <span class="comment">//账号密码正确</span></span><br><span class="line">                       <span class="comment">//根据用户唯一标识生成token</span></span><br><span class="line">                       <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> jwtHelper.createToken(Long.valueOf(loginUser.getUid()));</span><br><span class="line">   </span><br><span class="line">                       <span class="type">Map</span> <span class="variable">data</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">                       data.put(<span class="string">&quot;token&quot;</span>,token);</span><br><span class="line">   </span><br><span class="line">                       <span class="keyword">return</span> Result.ok(data);</span><br><span class="line">                   &#125;</span><br><span class="line">   </span><br><span class="line">                   <span class="comment">//密码错误</span></span><br><span class="line">                   <span class="keyword">return</span> Result.build(<span class="literal">null</span>,ResultCodeEnum.PASSWORD_ERROR);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
<li><p><strong>1.3  根据token获取用户数据</strong></p>
<ol>
<li><p>需求描述</p>
<p>客户端发送请求,提交token请求头,后端根据token请求头获取登录用户的详细信息并响应给客户端进行存储</p>
</li>
<li><p>接口描述</p>
<p>url地址：user&#x2F;getUserInfo</p>
<p>请求方式：GET</p>
<p>请求头：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">token: token内容</span><br></pre></td></tr></table></figure>
<p>响应数据：</p>
<p>成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">&quot;message&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;loginUser&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;uid&quot;</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;zhangsan&quot;</span>,</span><br><span class="line">            <span class="string">&quot;userPwd&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;nickName&quot;</span>: <span class="string">&quot;张三&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>失败</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>: <span class="number">504</span>,</span><br><span class="line">    <span class="string">&quot;message&quot;</span>: <span class="string">&quot;notLogin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>代码实现</p>
<ol>
<li>controller<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 地址: user/getUserInfo</span></span><br><span class="line"><span class="comment"> * 方式: get</span></span><br><span class="line"><span class="comment"> * 请求头: token = token内容</span></span><br><span class="line"><span class="comment"> * 返回:</span></span><br><span class="line"><span class="comment"> *    &#123;</span></span><br><span class="line"><span class="comment"> *     &quot;code&quot;: 200,</span></span><br><span class="line"><span class="comment"> *     &quot;message&quot;: &quot;success&quot;,</span></span><br><span class="line"><span class="comment"> *     &quot;data&quot;: &#123;</span></span><br><span class="line"><span class="comment"> *         &quot;loginUser&quot;: &#123;</span></span><br><span class="line"><span class="comment"> *             &quot;uid&quot;: 1,</span></span><br><span class="line"><span class="comment"> *             &quot;username&quot;: &quot;zhangsan&quot;,</span></span><br><span class="line"><span class="comment"> *             &quot;userPwd&quot;: &quot;&quot;,</span></span><br><span class="line"><span class="comment"> *             &quot;nickName&quot;: &quot;张三&quot;</span></span><br><span class="line"><span class="comment"> *         &#125;</span></span><br><span class="line"><span class="comment"> *      &#125;</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 大概流程:</span></span><br><span class="line"><span class="comment"> *    1.获取token,解析token对应的userId</span></span><br><span class="line"><span class="comment"> *    2.根据userId,查询用户数据</span></span><br><span class="line"><span class="comment"> *    3.将用户数据的密码置空,并且把用户数据封装到结果中key = loginUser</span></span><br><span class="line"><span class="comment"> *    4.失败返回504 (本次先写到当前业务,后期提取到拦截器和全局异常处理器)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;getUserInfo&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">userInfo</span><span class="params">(<span class="meta">@RequestHeader</span> String token)</span>&#123;</span><br><span class="line">    <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> userService.getUserInfo(token);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>service<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询用户数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> token</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> result封装</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">getUserInfo</span><span class="params">(String token)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.判定是否有效期</span></span><br><span class="line">    <span class="keyword">if</span> (jwtHelper.isExpiration(token)) &#123;</span><br><span class="line">        <span class="comment">//true过期,直接返回未登录</span></span><br><span class="line">        <span class="keyword">return</span> Result.build(<span class="literal">null</span>,ResultCodeEnum.NOTLOGIN);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.获取token对应的用户</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">userId</span> <span class="operator">=</span> jwtHelper.getUserId(token).intValue();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.查询数据</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.selectById(userId);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">        user.setUserPwd(<span class="literal">null</span>);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">data</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        data.put(<span class="string">&quot;loginUser&quot;</span>,user);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Result.build(<span class="literal">null</span>,ResultCodeEnum.NOTLOGIN);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
<li><p><strong>1.4  注册用户名检查</strong></p>
<ol>
<li><p>需求描述</p>
<p><img src="/image/checkuserName_RkV-nZcKMO.gif"></p>
<p>用户在注册时输入用户名时,立刻将用户名发送给后端,后端根据用户名查询用户名是否可用并做出响应</p>
</li>
<li><p>接口描述</p>
<p>url地址：user&#x2F;checkUserName</p>
<p>请求方式：POST</p>
<p>请求参数：param形式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=zhangsan</span><br></pre></td></tr></table></figure>
<p>响应数据：</p>
<p>成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="string">&quot;code&quot;</span>:<span class="string">&quot;200&quot;</span>,</span><br><span class="line">   <span class="string">&quot;message&quot;</span>:<span class="string">&quot;success&quot;</span></span><br><span class="line">   <span class="string">&quot;data&quot;</span>:&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>失败</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>:<span class="string">&quot;505&quot;</span>,</span><br><span class="line">   <span class="string">&quot;message&quot;</span>:<span class="string">&quot;用户名占用&quot;</span></span><br><span class="line">   <span class="string">&quot;data&quot;</span>:&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>代码实现</p>
<ol>
<li>controller<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * url地址：user/checkUserName</span></span><br><span class="line"><span class="comment"> * 请求方式：POST</span></span><br><span class="line"><span class="comment"> * 请求参数：param形式</span></span><br><span class="line"><span class="comment"> * username=zhangsan</span></span><br><span class="line"><span class="comment"> * 响应数据:</span></span><br><span class="line"><span class="comment"> * &#123;</span></span><br><span class="line"><span class="comment"> *    &quot;code&quot;:&quot;200&quot;,</span></span><br><span class="line"><span class="comment"> *    &quot;message&quot;:&quot;success&quot;</span></span><br><span class="line"><span class="comment"> *    &quot;data&quot;:&#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 实现步骤:</span></span><br><span class="line"><span class="comment"> *   1. 获取账号数据</span></span><br><span class="line"><span class="comment"> *   2. 根据账号进行数据库查询</span></span><br><span class="line"><span class="comment"> *   3. 结果封装</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;checkUserName&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">checkUserName</span><span class="params">(String username)</span>&#123;</span><br><span class="line">    <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> userService.checkUserName(username);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>service&#x20;<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查账号是否可以注册</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> username 账号信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">checkUserName</span><span class="params">(String username)</span> &#123;</span><br><span class="line"></span><br><span class="line">    LambdaQueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">    queryWrapper.eq(User::getUsername,username);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.selectOne(queryWrapper);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (user != <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> Result.build(<span class="literal">null</span>,ResultCodeEnum.USERNAME_USED);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Result.ok(<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
<li><p><strong>1.5  用户注册功能</strong></p>
<ol>
<li><p>需求描述</p>
<p><img src="/image/regist_HHgh8aMYtY.gif"></p>
<p>客户端将新用户信息发送给服务端,服务端将新用户存入数据库,存入之前做用户名是否被占用校验,校验通过响应成功提示,否则响应失败提示</p>
</li>
<li><p>接口描述</p>
<p>url地址：user&#x2F;regist</p>
<p>请求方式：POST</p>
<p>请求参数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>:<span class="string">&quot;zhangsan&quot;</span>,</span><br><span class="line">    <span class="string">&quot;userPwd&quot;</span>:<span class="string">&quot;123456&quot;</span>, </span><br><span class="line">    <span class="string">&quot;nickName&quot;</span>:<span class="string">&quot;张三&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>响应数据：</p>
<p>成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="string">&quot;code&quot;</span>:<span class="string">&quot;200&quot;</span>,</span><br><span class="line">   <span class="string">&quot;message&quot;</span>:<span class="string">&quot;success&quot;</span></span><br><span class="line">   <span class="string">&quot;data&quot;</span>:&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>失败</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="string">&quot;code&quot;</span>:<span class="string">&quot;505&quot;</span>,</span><br><span class="line">   <span class="string">&quot;message&quot;</span>:<span class="string">&quot;用户名占用&quot;</span></span><br><span class="line">   <span class="string">&quot;data&quot;</span>:&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>代码实现</p>
<ol>
<li>controller<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* url地址：user/regist</span></span><br><span class="line"><span class="comment">* 请求方式：POST</span></span><br><span class="line"><span class="comment">* 请求参数：</span></span><br><span class="line"><span class="comment">* &#123;</span></span><br><span class="line"><span class="comment">*     &quot;username&quot;:&quot;zhangsan&quot;,</span></span><br><span class="line"><span class="comment">*     &quot;userPwd&quot;:&quot;123456&quot;,</span></span><br><span class="line"><span class="comment">*     &quot;nickName&quot;:&quot;张三&quot;</span></span><br><span class="line"><span class="comment">* &#125;</span></span><br><span class="line"><span class="comment">* 响应数据：</span></span><br><span class="line"><span class="comment">* &#123;</span></span><br><span class="line"><span class="comment">*    &quot;code&quot;:&quot;200&quot;,</span></span><br><span class="line"><span class="comment">*    &quot;message&quot;:&quot;success&quot;</span></span><br><span class="line"><span class="comment">*    &quot;data&quot;:&#123;&#125;</span></span><br><span class="line"><span class="comment">* &#125;</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* 实现步骤:</span></span><br><span class="line"><span class="comment">*   1. 将密码加密</span></span><br><span class="line"><span class="comment">*   2. 将数据插入</span></span><br><span class="line"><span class="comment">*   3. 判断结果,成 返回200 失败 505</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@PostMapping(&quot;regist&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">regist</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span>&#123;</span><br><span class="line">  <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> userService.regist(user);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>service&#x20;<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">regist</span><span class="params">(User user)</span> &#123;</span><br><span class="line">    LambdaQueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">    queryWrapper.eq(User::getUsername,user.getUsername());</span><br><span class="line">    <span class="type">Long</span> <span class="variable">count</span> <span class="operator">=</span> userMapper.selectCount(queryWrapper);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (count &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> Result.build(<span class="literal">null</span>,ResultCodeEnum.USERNAME_USED);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    user.setUserPwd(MD5Util.encrypt(user.getUserPwd()));</span><br><span class="line">    <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> userMapper.insert(user);</span><br><span class="line">    System.out.println(<span class="string">&quot;rows = &quot;</span> + rows);</span><br><span class="line">    <span class="keyword">return</span> Result.ok(<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
</ul>
<h3 id="4-2-首页模块开发"><a href="#4-2-首页模块开发" class="headerlink" title="4.2 首页模块开发"></a>4.2 首页模块开发</h3><ul>
<li><p><strong>2.1 查询首页分类</strong></p>
<ol>
<li><p>需求描述</p>
<p><img src="/image/image_AmGGS4B3gy.png"></p>
<p>进入新闻首页,查询所有分类并动态展示新闻类别栏位</p>
</li>
<li><p>接口描述</p>
<p>url地址：portal&#x2F;findAllTypes</p>
<p>请求方式：get</p>
<p>请求参数：无</p>
<p>响应数据：</p>
<p>成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="string">&quot;code&quot;</span>:<span class="string">&quot;200&quot;</span>,</span><br><span class="line">   <span class="string">&quot;message&quot;</span>:<span class="string">&quot;OK&quot;</span></span><br><span class="line">   <span class="string">&quot;data&quot;</span>:&#123;</span><br><span class="line">            [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;tid&quot;</span>:<span class="string">&quot;1&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;tname&quot;</span>:<span class="string">&quot;新闻&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;tid&quot;</span>:<span class="string">&quot;2&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;tname&quot;</span>:<span class="string">&quot;体育&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;tid&quot;</span>:<span class="string">&quot;3&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;tname&quot;</span>:<span class="string">&quot;娱乐&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;tid&quot;</span>:<span class="string">&quot;4&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;tname&quot;</span>:<span class="string">&quot;科技&quot;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;tid&quot;</span>:<span class="string">&quot;5&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;tname&quot;</span>:<span class="string">&quot;其他&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>代码实现</p>
<ol>
<li>controller<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;portal&quot;)</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PortalController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TypeService typeService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询全部类别信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;findAllTypes&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">findAllTypes</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//直接调用业务层,查询全部数据</span></span><br><span class="line">        List&lt;Type&gt; list = typeService.list();</span><br><span class="line">        <span class="keyword">return</span>  Result.ok(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
<li><p><strong>2.2 分页查询首页头条信息</strong></p>
<ol>
<li><p>需求描述</p>
<p><img src="/image/image_deWHSPD7Ma.png"></p>
<ul>
<li>客户端向服务端发送查询关键字,新闻类别,页码数,页大小</li>
<li>服务端根据条件搜索分页信息,返回含页码数,页大小,总页数,总记录数,当前页数据等信息,并根据时间降序,浏览量降序排序</li>
</ul>
</li>
<li><p>接口描述</p>
<p>url地址：portal&#x2F;findNewsPage</p>
<p>请求方式：post</p>
<p>请求参数:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;keyWords&quot;</span><span class="punctuation">:</span><span class="string">&quot;马斯克&quot;</span><span class="punctuation">,</span> <span class="comment">// 搜索标题关键字</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span>           <span class="comment">// 新闻类型</span></span><br><span class="line">    <span class="attr">&quot;pageNum&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span>        <span class="comment">// 页码数</span></span><br><span class="line">    <span class="attr">&quot;pageSize&quot;</span><span class="punctuation">:</span><span class="number">10</span>     <span class="comment">// 页大小</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>响应数据：</p>
<p>成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="string">&quot;code&quot;</span>:<span class="string">&quot;200&quot;</span>,</span><br><span class="line">   <span class="string">&quot;message&quot;</span>:<span class="string">&quot;success&quot;</span></span><br><span class="line">   <span class="string">&quot;data&quot;</span>:&#123;</span><br><span class="line">      <span class="string">&quot;pageInfo&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;pageData&quot;</span>:[</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="string">&quot;hid&quot;</span>:<span class="string">&quot;1&quot;</span>,                     <span class="comment">// 新闻id </span></span><br><span class="line">            <span class="string">&quot;title&quot;</span>:<span class="string">&quot;尚硅谷宣布 ... ...&quot;</span>,   <span class="comment">// 新闻标题</span></span><br><span class="line">            <span class="string">&quot;type&quot;</span>:<span class="string">&quot;1&quot;</span>,                    <span class="comment">// 新闻所属类别编号</span></span><br><span class="line">            <span class="string">&quot;pageViews&quot;</span>:<span class="string">&quot;40&quot;</span>,              <span class="comment">// 新闻浏览量</span></span><br><span class="line">            <span class="string">&quot;pastHours&quot;</span>:<span class="string">&quot;3&quot;</span> ,              <span class="comment">// 发布时间已过小时数</span></span><br><span class="line">            <span class="string">&quot;publisher&quot;</span>:<span class="string">&quot;1&quot;</span>                <span class="comment">// 发布用户ID</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;hid&quot;</span>:<span class="string">&quot;1&quot;</span>,                     <span class="comment">// 新闻id </span></span><br><span class="line">            <span class="string">&quot;title&quot;</span>:<span class="string">&quot;尚硅谷宣布 ... ...&quot;</span>,   <span class="comment">// 新闻标题</span></span><br><span class="line">            <span class="string">&quot;type&quot;</span>:<span class="string">&quot;1&quot;</span>,                    <span class="comment">// 新闻所属类别编号</span></span><br><span class="line">            <span class="string">&quot;pageViews&quot;</span>:<span class="string">&quot;40&quot;</span>,              <span class="comment">// 新闻浏览量</span></span><br><span class="line">            <span class="string">&quot;pastHours&quot;</span>:<span class="string">&quot;3&quot;</span>,              <span class="comment">// 发布时间已过小时数</span></span><br><span class="line">            <span class="string">&quot;publisher&quot;</span>:<span class="string">&quot;1&quot;</span>                <span class="comment">// 发布用户ID</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;hid&quot;</span>:<span class="string">&quot;1&quot;</span>,                     <span class="comment">// 新闻id </span></span><br><span class="line">            <span class="string">&quot;title&quot;</span>:<span class="string">&quot;尚硅谷宣布 ... ...&quot;</span>,   <span class="comment">// 新闻标题</span></span><br><span class="line">            <span class="string">&quot;type&quot;</span>:<span class="string">&quot;1&quot;</span>,                    <span class="comment">// 新闻所属类别编号</span></span><br><span class="line">            <span class="string">&quot;pageViews&quot;</span>:<span class="string">&quot;40&quot;</span>,              <span class="comment">// 新闻浏览量</span></span><br><span class="line">            <span class="string">&quot;pastHours&quot;</span>:<span class="string">&quot;3&quot;</span>,               <span class="comment">// 发布时间已过小时数</span></span><br><span class="line">            <span class="string">&quot;publisher&quot;</span>:<span class="string">&quot;1&quot;</span>                <span class="comment">// 发布用户ID</span></span><br><span class="line">        &#125;</span><br><span class="line">        ],</span><br><span class="line">      <span class="string">&quot;pageNum&quot;</span>:<span class="number">1</span>,    <span class="comment">//页码数</span></span><br><span class="line">      <span class="string">&quot;pageSize&quot;</span>:<span class="number">10</span>,  <span class="comment">// 页大小</span></span><br><span class="line">      <span class="string">&quot;totalPage&quot;</span>:<span class="number">20</span>, <span class="comment">// 总页数</span></span><br><span class="line">      <span class="string">&quot;totalSize&quot;</span>:<span class="number">200</span> <span class="comment">// 总记录数</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>代码实现</p>
<ol>
<li><p>准备条件实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PortalVo</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String keyWords;</span><br><span class="line">    <span class="keyword">private</span> Integer type;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">pageNum</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">pageSize</span> <span class="operator">=</span><span class="number">10</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 首页分页查询</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;findNewPage&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">findNewPage</span><span class="params">(<span class="meta">@RequestBody</span> PortalVo portalVo)</span>&#123;</span><br><span class="line">    <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> headlineService.findNewPage(portalVo);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>service</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HeadlineServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;HeadlineMapper, Headline&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">HeadlineService</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> HeadlineMapper headlineMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 首页数据查询</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> portalVo</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">findNewPage</span><span class="params">(PortalVo portalVo)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.条件拼接 需要非空判断</span></span><br><span class="line">        LambdaQueryWrapper&lt;Headline&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">        queryWrapper.like(!StringUtils.isEmpty(portalVo.getKeyWords()),Headline::getTitle,portalVo.getKeyWords())</span><br><span class="line">                .eq(portalVo.getType()!= <span class="literal">null</span>,Headline::getType,portalVo.getType());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.分页参数</span></span><br><span class="line">        IPage&lt;Headline&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(portalVo.getPageNum(),portalVo.getPageSize());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.分页查询</span></span><br><span class="line">        <span class="comment">//查询的结果 &quot;pastHours&quot;:&quot;3&quot;   // 发布时间已过小时数 我们查询返回一个map</span></span><br><span class="line">        <span class="comment">//自定义方法</span></span><br><span class="line">        headlineMapper.selectPageMap(page, portalVo);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.结果封装</span></span><br><span class="line">        <span class="comment">//分页数据封装</span></span><br><span class="line">        Map&lt;String,Object&gt; pageInfo =<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        pageInfo.put(<span class="string">&quot;pageData&quot;</span>,page.getRecords());</span><br><span class="line">        pageInfo.put(<span class="string">&quot;pageNum&quot;</span>,page.getCurrent());</span><br><span class="line">        pageInfo.put(<span class="string">&quot;pageSize&quot;</span>,page.getSize());</span><br><span class="line">        pageInfo.put(<span class="string">&quot;totalPage&quot;</span>,page.getPages());</span><br><span class="line">        pageInfo.put(<span class="string">&quot;totalSize&quot;</span>,page.getTotal());</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Object&gt; pageInfoMap=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        pageInfoMap.put(<span class="string">&quot;pageInfo&quot;</span>,pageInfo);</span><br><span class="line">        <span class="comment">// 响应JSON</span></span><br><span class="line">        <span class="keyword">return</span> Result.ok(pageInfoMap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>mapper</p>
<p>接口:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">HeadlineMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;Headline&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//自定义分页查询方法</span></span><br><span class="line">    IPage&lt;Map&gt; <span class="title function_">selectPageMap</span><span class="params">(IPage&lt;?&gt; page, </span></span><br><span class="line"><span class="params">                <span class="meta">@Param(&quot;portalVo&quot;)</span> PortalVo portalVo)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>mapperxml:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=<span class="string">&quot;selectPageMap&quot;</span> resultType=<span class="string">&quot;map&quot;</span>&gt;</span><br><span class="line">    select hid,title,type,page_views pageViews,TIMESTAMPDIFF(HOUR,create_time,NOW()) pastHours,</span><br><span class="line">            publisher from news_headline where is_deleted=<span class="number">0</span></span><br><span class="line">            &lt;<span class="keyword">if</span> test=<span class="string">&quot;portalVo.keyWords !=null and portalVo.keyWords.length()&gt;0 &quot;</span>&gt;</span><br><span class="line">                and title like <span class="title function_">concat</span><span class="params">(<span class="string">&#x27;%&#x27;</span>,#&#123;portalVo.keyWords&#125;,<span class="string">&#x27;%&#x27;</span>)</span></span><br><span class="line">            &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">            &lt;<span class="keyword">if</span> test=<span class="string">&quot;portalVo.type != null and portalVo.type != 0&quot;</span>&gt;</span><br><span class="line">                <span class="type">and</span> <span class="variable">type</span> <span class="operator">=</span> #&#123;portalVo.type&#125;</span><br><span class="line">            &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
<li><p><strong>2.3 查询头条详情</strong></p>
<ol>
<li><p>需求描述</p>
<p><img src="/image/image_8Na6D2JJhl.png"></p>
<ul>
<li>用户点击”查看全文”时,向服务端发送新闻id</li>
<li>后端根据新闻id查询完整新闻文章信息并返回</li>
<li>后端要同时让新闻的浏览量+1</li>
</ul>
</li>
<li><p>接口描述</p>
<p>url地址：portal&#x2F;showHeadlineDetail</p>
<p>请求方式：post</p>
<p>请求参数:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hid=<span class="number">1</span> param形成参数</span><br></pre></td></tr></table></figure>
<p>响应数据：</p>
<p>成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>:<span class="string">&quot;200&quot;</span>,</span><br><span class="line">    <span class="string">&quot;message&quot;</span>:<span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;headline&quot;</span>:&#123;</span><br><span class="line">            <span class="string">&quot;hid&quot;</span>:<span class="string">&quot;1&quot;</span>,                     <span class="comment">// 新闻id </span></span><br><span class="line">            <span class="string">&quot;title&quot;</span>:<span class="string">&quot;马斯克宣布 ... ...&quot;</span>,   <span class="comment">// 新闻标题</span></span><br><span class="line">            <span class="string">&quot;article&quot;</span>:<span class="string">&quot;... ...&quot;</span>            <span class="comment">// 新闻正文</span></span><br><span class="line">            <span class="string">&quot;type&quot;</span>:<span class="string">&quot;1&quot;</span>,                    <span class="comment">// 新闻所属类别编号</span></span><br><span class="line">            <span class="string">&quot;typeName&quot;</span>:<span class="string">&quot;科技&quot;</span>,             <span class="comment">// 新闻所属类别</span></span><br><span class="line">            <span class="string">&quot;pageViews&quot;</span>:<span class="string">&quot;40&quot;</span>,              <span class="comment">// 新闻浏览量</span></span><br><span class="line">            <span class="string">&quot;pastHours&quot;</span>:<span class="string">&quot;3&quot;</span> ,              <span class="comment">// 发布时间已过小时数</span></span><br><span class="line">            <span class="string">&quot;publisher&quot;</span>:<span class="string">&quot;1&quot;</span> ,              <span class="comment">// 发布用户ID</span></span><br><span class="line">            <span class="string">&quot;author&quot;</span>:<span class="string">&quot;张三&quot;</span>                 <span class="comment">// 新闻作者</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>代码实现</p>
<ol>
<li><p>controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 首页详情接口</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> hid</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;showHeadlineDetail&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">showHeadlineDetail</span><span class="params">(Integer hid)</span>&#123;</span><br><span class="line">    <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> headlineService.showHeadlineDetail(hid);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>service</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 详情数据查询</span></span><br><span class="line"><span class="comment"> * &quot;headline&quot;:&#123;</span></span><br><span class="line"><span class="comment"> * &quot;hid&quot;:&quot;1&quot;,                     // 新闻id</span></span><br><span class="line"><span class="comment"> * &quot;title&quot;:&quot;马斯克宣布 ... ...&quot;,   // 新闻标题</span></span><br><span class="line"><span class="comment"> * &quot;article&quot;:&quot;... ...&quot;            // 新闻正文</span></span><br><span class="line"><span class="comment"> * &quot;type&quot;:&quot;1&quot;,                    // 新闻所属类别编号</span></span><br><span class="line"><span class="comment"> * &quot;typeName&quot;:&quot;科技&quot;,             // 新闻所属类别</span></span><br><span class="line"><span class="comment"> * &quot;pageViews&quot;:&quot;40&quot;,              // 新闻浏览量</span></span><br><span class="line"><span class="comment"> * &quot;pastHours&quot;:&quot;3&quot; ,              // 发布时间已过小时数</span></span><br><span class="line"><span class="comment"> * &quot;publisher&quot;:&quot;1&quot; ,              // 发布用户ID</span></span><br><span class="line"><span class="comment"> * &quot;author&quot;:&quot;张三&quot;                 // 新闻作者</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> * 注意: 是多表查询 , 需要更新浏览量+1</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> hid</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">showHeadlineDetail</span><span class="params">(Integer hid)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.实现根据id的查询(多表</span></span><br><span class="line">    <span class="type">Map</span> <span class="variable">headLineDetail</span> <span class="operator">=</span> headlineMapper.selectDetailMap(hid);</span><br><span class="line">    <span class="comment">//2.拼接头条对象(阅读量和version)进行数据更新</span></span><br><span class="line">    <span class="type">Headline</span> <span class="variable">headline</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Headline</span>();</span><br><span class="line">    headline.setHid(hid);</span><br><span class="line">    headline.setPageViews((Integer) headLineDetail.get(<span class="string">&quot;pageViews&quot;</span>)+<span class="number">1</span>); <span class="comment">//阅读量+1</span></span><br><span class="line">    headline.setVersion((Integer) headLineDetail.get(<span class="string">&quot;version&quot;</span>)); <span class="comment">//设置版本</span></span><br><span class="line">    headlineMapper.updateById(headline);</span><br><span class="line"></span><br><span class="line">    Map&lt;String,Object&gt; pageInfoMap=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    pageInfoMap.put(<span class="string">&quot;headline&quot;</span>,headLineDetail);</span><br><span class="line">    <span class="keyword">return</span> Result.ok(pageInfoMap);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>mapper</p>
<p>接口:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分页查询头条详情</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> hid</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Map <span class="title function_">selectDetailMap</span><span class="params">(Integer hid)</span>;</span><br></pre></td></tr></table></figure>
<p>mapperxml:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--    Map <span class="title function_">selectDetailMap</span><span class="params">(Integer hid)</span>;--&gt;</span><br><span class="line">&lt;select id=<span class="string">&quot;selectDetailMap&quot;</span> resultType=<span class="string">&quot;map&quot;</span>&gt;</span><br><span class="line">    select hid,title,article,type, h.version ,tname typeName ,page_views pageViews</span><br><span class="line">            ,TIMESTAMPDIFF(HOUR,create_time,NOW()) pastHours,publisher</span><br><span class="line">                    ,nick_name author from news_headline h</span><br><span class="line">                        left join news_type t on h.type = t.tid</span><br><span class="line">                                left join news_user u  on h.publisher = u.uid</span><br><span class="line">                                            <span class="type">where</span> <span class="variable">hid</span> <span class="operator">=</span> #&#123;hid&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
</ul>
<h3 id="4-3-头条模块开发"><a href="#4-3-头条模块开发" class="headerlink" title="4.3 头条模块开发"></a>4.3 头条模块开发</h3><ul>
<li>**3.1 登陆验证和保护 **<ol>
<li><p>需求描述</p>
<p><img src="/image/image_z3JT_Q93XX.png"></p>
<ul>
<li>客户端在进入发布页前、发布新闻前、进入修改页前、修改前、删除新闻前先向服务端发送请求携带token请求头</li>
<li>后端接收token请求头后,校验用户登录是否过期并做响应</li>
<li>前端根据响应信息提示用户进入登录页还是进入正常业务页面</li>
</ul>
</li>
<li><p>接口描述</p>
<p>url地址：user&#x2F;checkLogin</p>
<p>请求方式：get</p>
<p>请求参数:  无</p>
<p>请求头： token: 用户token</p>
<p>响应数据：</p>
<p>未过期：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>:<span class="string">&quot;200&quot;</span>,</span><br><span class="line">    <span class="string">&quot;message&quot;</span>:<span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>:&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>过期：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>:<span class="string">&quot;504&quot;</span>,</span><br><span class="line">    <span class="string">&quot;message&quot;</span>:<span class="string">&quot;loginExpired&quot;</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>:&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>代码实现</p>
<ol>
<li>controller 【登录检查】<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;checkLogin&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">checkLogin</span><span class="params">(<span class="meta">@RequestHeader</span> String token)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isEmpty(token) || jwtHelper.isExpiration(token))&#123;</span><br><span class="line">        <span class="comment">//没有传或者过期 未登录</span></span><br><span class="line">        <span class="keyword">return</span> Result.build(<span class="literal">null</span>, ResultCodeEnum.NOTLOGIN);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> Result.ok(<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>拦截器 【所有&#x2F;headline开头都需要检查登陆】<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginProtectInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JwtHelper jwtHelper;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isEmpty(token) || jwtHelper.isExpiration(token))&#123;</span><br><span class="line">            <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> Result.build(<span class="literal">null</span>, ResultCodeEnum.NOTLOGIN);</span><br><span class="line">            <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">            <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> objectMapper.writeValueAsString(result);</span><br><span class="line">            response.getWriter().print(json);</span><br><span class="line">            <span class="comment">//拦截</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//放行</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>拦截器配置<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginProtectInterceptor loginProtectInterceptor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(loginProtectInterceptor).addPathPatterns(<span class="string">&quot;/headline/**&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
<li><strong>3.2 头条发布实现</strong><ol>
<li><p>需求描述</p>
<p><img src="/image/1683883660552_8svcbagw2y.png"></p>
<ul>
<li>用户在客户端输入发布的新闻信息完毕后</li>
<li>发布前先请求后端的登录校验接口验证登录</li>
<li>登录通过则提交新闻信息</li>
<li>后端将新闻信息存入数据库</li>
</ul>
</li>
<li><p>接口描述</p>
<p>url地址：headline&#x2F;publish</p>
<p>请求方式：post</p>
<p>请求头:&#x20;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">token: ... ...</span><br></pre></td></tr></table></figure>
<p>请求参数:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;尚硅谷宣布 ... ...&quot;</span><span class="punctuation">,</span>   <span class="comment">// 文章标题</span></span><br><span class="line">    <span class="attr">&quot;article&quot;</span><span class="punctuation">:</span><span class="string">&quot;... ...&quot;</span><span class="punctuation">,</span>          <span class="comment">// 文章内容</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;1&quot;</span>                    <span class="comment">// 文章类别</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>响应数据：</p>
<p>未登录</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>:<span class="string">&quot;504&quot;</span>,</span><br><span class="line">    <span class="string">&quot;message&quot;</span>:<span class="string">&quot;loginExpired&quot;</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>:&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>:<span class="string">&quot;200&quot;</span>,</span><br><span class="line">    <span class="string">&quot;message&quot;</span>:<span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>:&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>代码实现</p>
<ol>
<li>controller<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 实现步骤:</span></span><br><span class="line"><span class="comment"> *   1. token获取userId [无需校验,拦截器会校验]</span></span><br><span class="line"><span class="comment"> *   2. 封装headline数据</span></span><br><span class="line"><span class="comment"> *   3. 插入数据即可</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;publish&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">publish</span><span class="params">(<span class="meta">@RequestBody</span> Headline headline,<span class="meta">@RequestHeader</span> String token)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">userId</span> <span class="operator">=</span> jwtHelper.getUserId(token).intValue();</span><br><span class="line">    headline.setPublisher(userId);</span><br><span class="line">    <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> headlineService.publish(headline);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>service<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 发布数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> headline</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">publish</span><span class="params">(Headline headline)</span> &#123;</span><br><span class="line">    headline.setCreateTime(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    headline.setUpdateTime(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    headline.setPageViews(<span class="number">0</span>);</span><br><span class="line">    headlineMapper.insert(headline);</span><br><span class="line">    <span class="keyword">return</span> Result.ok(<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
<li><strong>3.3 修改头条回显</strong><ol>
<li><p>需求描述</p>
<p><img src="/image/image_L870gB_yYk.png"></p>
<ul>
<li>前端先调用登录校验接口,校验登录是否过期</li>
<li>登录校验通过后 ,则根据新闻id查询新闻的完整信息并响应给前端</li>
</ul>
</li>
<li><p>接口描述</p>
<p>url地址：headline&#x2F;findHeadlineByHid</p>
<p>请求方式：post</p>
<p>请求参数:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hid=<span class="number">1</span> param形成参数</span><br></pre></td></tr></table></figure>
<p>响应数据：</p>
<p>成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>:<span class="string">&quot;200&quot;</span>,</span><br><span class="line">    <span class="string">&quot;message&quot;</span>:<span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;headline&quot;</span>:&#123;</span><br><span class="line">            <span class="string">&quot;hid&quot;</span>:<span class="string">&quot;1&quot;</span>,</span><br><span class="line">            <span class="string">&quot;title&quot;</span>:<span class="string">&quot;马斯克宣布&quot;</span>,</span><br><span class="line">            <span class="string">&quot;article&quot;</span>:<span class="string">&quot;... ... &quot;</span>,</span><br><span class="line">            <span class="string">&quot;type&quot;</span>:<span class="string">&quot;2&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>代码实现</p>
<ol>
<li>controller<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;findHeadlineByHid&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">findHeadlineByHid</span><span class="params">(Integer hid)</span>&#123;</span><br><span class="line">    <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> headlineService.findHeadlineByHid(hid);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>service<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据id查询详情</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> hid</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">findHeadlineByHid</span><span class="params">(Integer hid)</span> &#123;</span><br><span class="line">    <span class="type">Headline</span> <span class="variable">headline</span> <span class="operator">=</span> headlineMapper.selectById(hid);</span><br><span class="line">    Map&lt;String,Object&gt; pageInfoMap=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    pageInfoMap.put(<span class="string">&quot;headline&quot;</span>,headline);</span><br><span class="line">    <span class="keyword">return</span> Result.ok(pageInfoMap);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
<li><strong>3.4 头条修改实现</strong><ol>
<li><p>需求描述</p>
<ul>
<li>客户端将新闻信息修改后,提交前先请求登录校验接口校验登录状态</li>
<li>登录校验通过则提交修改后的新闻信息,后端接收并更新进入数据库</li>
</ul>
</li>
<li><p>接口描述</p>
<p>url地址：headline&#x2F;update</p>
<p>请求方式：post</p>
<p>请求参数:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;hid&quot;</span><span class="punctuation">:</span><span class="string">&quot;1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span><span class="string">&quot;尚硅谷宣布 ... ...&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;article&quot;</span><span class="punctuation">:</span><span class="string">&quot;... ...&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;2&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>响应数据：</p>
<p>成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>:<span class="string">&quot;200&quot;</span>,</span><br><span class="line">    <span class="string">&quot;message&quot;</span>:<span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>:&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>代码实现</p>
<ol>
<li>controller<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;update&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> Headline headline)</span>&#123;</span><br><span class="line">    <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> headlineService.updateHeadLine(headline);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>service<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改业务</span></span><br><span class="line"><span class="comment"> * 1.查询version版本</span></span><br><span class="line"><span class="comment"> * 2.补全属性,修改时间 , 版本!</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> headline</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">updateHeadLine</span><span class="params">(Headline headline)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//读取版本</span></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">version</span> <span class="operator">=</span> headlineMapper.selectById(headline.getHid()).getVersion();</span><br><span class="line"></span><br><span class="line">    headline.setVersion(version);</span><br><span class="line">    headline.setUpdateTime(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line"></span><br><span class="line">    headlineMapper.updateById(headline);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Result.ok(<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
<li><strong>3.5 删除头条功能</strong><ol>
<li><p>需求描述</p>
<p><img src="/image/image_QD2YtdsmHQ.png"></p>
<ul>
<li>将要删除的新闻id发送给服务端</li>
<li>服务端校验登录是否过期,未过期则直接删除,过期则响应登录过期信息</li>
</ul>
</li>
<li><p>接口描述</p>
<p>url地址：headline&#x2F;removeByHid</p>
<p>请求方式：post</p>
<p>请求参数:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hid=<span class="number">1</span> param形成参数</span><br></pre></td></tr></table></figure>
<p>响应数据：</p>
<p>成功</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>:<span class="string">&quot;200&quot;</span>,</span><br><span class="line">    <span class="string">&quot;message&quot;</span>:<span class="string">&quot;success&quot;</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>:&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>代码实现</p>
<ol>
<li>controller<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;removeByHid&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">removeById</span><span class="params">(Integer hid)</span>&#123;</span><br><span class="line">    headlineService.removeById(hid);</span><br><span class="line">    <span class="keyword">return</span> Result.ok(<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
</li>
</ul>
<h2 id="五、前后端联调"><a href="#五、前后端联调" class="headerlink" title="五、前后端联调"></a>五、前后端联调</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/11/14/ssm-md-master/%E6%96%B0%E7%89%88SSM%E6%95%B4%E5%90%88+SpringBoot3%E7%AC%94%E8%AE%B0/%E5%85%AB%E3%80%81%E7%BB%88%E6%9E%81%E5%AE%9E%E6%88%98%EF%BC%9ASpringBoot%E7%89%88%E5%BE%AE%E5%A4%B4%E6%9D%A1%E5%AE%9E%E6%88%98/%E5%85%AB%E3%80%81%E7%BB%88%E6%9E%81%E5%AE%9E%E6%88%98%EF%BC%9ASpringBoot%E7%89%88%E5%BE%AE%E5%A4%B4%E6%9D%A1%E5%AE%9E%E6%88%98/" data-id="cloxtn0cz00385gye6lmubnv7" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/11/14/ssm-md-master/%E6%96%B0%E7%89%88SSM%E6%95%B4%E5%90%88+SpringBoot3%E7%AC%94%E8%AE%B0/%E5%85%AD%E3%80%81%E5%BF%AB%E9%80%9F%E5%90%AF%E5%8A%A8%E6%A1%86%E6%9E%B6%EF%BC%9ASpringBoot3%E5%AE%9E%E6%88%98/%E5%85%AD%E3%80%81%E5%BF%AB%E9%80%9F%E5%90%AF%E5%8A%A8%E6%A1%86%E6%9E%B6%EF%BC%9ASpringBoot3%E5%AE%9E%E6%88%98/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2023/11/14/ssm-md-master/%E6%96%B0%E7%89%88SSM%E6%95%B4%E5%90%88+SpringBoot3%E7%AC%94%E8%AE%B0/%E4%BA%94%E3%80%81%E6%A1%86%E6%9E%B6%E5%AE%9E%E6%88%98%EF%BC%9ASSM%E6%95%B4%E5%90%88%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E6%88%98/%E4%BA%94%E3%80%81%E6%A1%86%E6%9E%B6%E5%AE%9E%E6%88%98%EF%BC%9ASSM%E6%95%B4%E5%90%88%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E6%88%98/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/11/14/ssm-md-master/%E6%96%B0%E7%89%88SSM%E6%95%B4%E5%90%88+SpringBoot3%E7%AC%94%E8%AE%B0/%E5%9B%9B%E3%80%81SpringMVC%E5%AE%9E%E6%88%98%EF%BC%9A%E6%9E%84%E5%BB%BA%E9%AB%98%E6%95%88%E8%A1%A8%E8%BF%B0%E5%B1%82%E6%A1%86%E6%9E%B6/%E5%9B%9B%E3%80%81SpringMVC%E5%AE%9E%E6%88%98%EF%BC%9A%E6%9E%84%E5%BB%BA%E9%AB%98%E6%95%88%E8%A1%A8%E8%BF%B0%E5%B1%82%E6%A1%86%E6%9E%B6/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/11/14/ssm-md-master/%E6%96%B0%E7%89%88SSM%E6%95%B4%E5%90%88+SpringBoot3%E7%AC%94%E8%AE%B0/%E5%85%AD%E3%80%81%E5%BF%AB%E9%80%9F%E5%90%AF%E5%8A%A8%E6%A1%86%E6%9E%B6%EF%BC%9ASpringBoot3%E5%AE%9E%E6%88%98/%E5%85%AD%E3%80%81%E5%BF%AB%E9%80%9F%E5%90%AF%E5%8A%A8%E6%A1%86%E6%9E%B6%EF%BC%9ASpringBoot3%E5%AE%9E%E6%88%98/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/11/14/ssm-md-master/%E6%96%B0%E7%89%88SSM%E6%95%B4%E5%90%88+SpringBoot3%E7%AC%94%E8%AE%B0/%E5%85%AB%E3%80%81%E7%BB%88%E6%9E%81%E5%AE%9E%E6%88%98%EF%BC%9ASpringBoot%E7%89%88%E5%BE%AE%E5%A4%B4%E6%9D%A1%E5%AE%9E%E6%88%98/%E5%85%AB%E3%80%81%E7%BB%88%E6%9E%81%E5%AE%9E%E6%88%98%EF%BC%9ASpringBoot%E7%89%88%E5%BE%AE%E5%A4%B4%E6%9D%A1%E5%AE%9E%E6%88%98/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/11/14/ssm-md-master/%E6%96%B0%E7%89%88SSM%E6%95%B4%E5%90%88+SpringBoot3%E7%AC%94%E8%AE%B0/%E4%BA%94%E3%80%81%E6%A1%86%E6%9E%B6%E5%AE%9E%E6%88%98%EF%BC%9ASSM%E6%95%B4%E5%90%88%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E6%88%98/%E4%BA%94%E3%80%81%E6%A1%86%E6%9E%B6%E5%AE%9E%E6%88%98%EF%BC%9ASSM%E6%95%B4%E5%90%88%E5%8E%9F%E7%90%86%E5%92%8C%E5%AE%9E%E6%88%98/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/11/14/ssm-md-master/%E6%96%B0%E7%89%88SSM%E6%95%B4%E5%90%88+SpringBoot3%E7%AC%94%E8%AE%B0/%E4%BA%8C%E3%80%81SpringFramework%E5%AE%9E%E6%88%98%E6%8C%87%E5%8D%97/%E4%BA%8C%E3%80%81SpringFramework%E5%AE%9E%E6%88%98%E6%8C%87%E5%8D%97/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>